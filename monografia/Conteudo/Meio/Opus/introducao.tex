\chapter{\textbf{Opus}}
\label{opus}

A aplicação que gerencia os dispositivos, a abstração do edifício no sistema e o nível de acesso de usuários a dispositivos específicos
é chamada de \emph{Opus}, nela estão contido os \emph{drivers} que são responsáveis por se comunicar com os dispositivos.

O \emph{Opus} foi desenvolvido em Python, especificamente na versão 3.12.2 e faz uso de diversas bibliotecas externas para seu funcionamento,
sendo algumas das mais importantes:
\begin{itemize}
    \item getmac;
    \item paho-mqtt;
    \item PyYAML;
    \item SQLAlchemy;
\end{itemize}

A aplicação é organizada em quatro módulos principais, como ilustrado na figura \ref{fig:opus1}.
\begin{figure}[h!]
    \conteudoFigura
    [Elaborado pelo Autor (2024)]
    {0.7}
    {opus1.png}
    {Módulos do Opus}
    {fig:opus1}
\end{figure}

Alguns módulos podem ser alterados conforme for descrito no arquivo de configuração do \emph{Opus}, o arquivo de configuração é um arquivo texto
escrito em YAML, onde o usuário pode alterar o comportamento do \emph{Opus} sem a necessidade de alterar o código fonte.
Um exemplo de arquivo de configuração é mostrado na figura \ref{fig:opus2}.
\begin{figure}[h!]
    \conteudoFigura
    [Elaborado pelo Autor (2024)]
    {0.2}
    {opus-config.png}
    {Exemplo de arquivo de configuração}
    {fig:opus2}
\end{figure}


Módulos como \emph{drivers} e \emph{interfaces} terão seus objetos carregados no ambiente de execução do \emph{Opus}
através de um dicionário, onde a chave é o nome do módulo e o valor é objeto.
Sendo assim para acessar um \emph{driver} ou \emph{interface} basta acessar o dicionário com o nome do módulo como no exemplo
a seguir:
\begin{lstlisting}[language=Python]
    interfaces['nome_da_interface'].metodo_desejado()
\end{lstlisting}